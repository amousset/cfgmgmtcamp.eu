<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=MobileOptimized content=width><meta name=HandheldFriendly content=true><meta name=apple-mobile-web-app-capable content=yes><meta name=twitter:card content=summary><meta name=twitter:site content=@cfgmgmtcamp><meta name=twitter:creator content=@cfgmgmtcamp><meta name=twitter:title content="Agent-side functions in Puppet 6. Wait, that's a thing?"><meta name=twitter:description content="For a long time now, a common refrain in the #puppet IRC and now Slack channels has been explaining how Puppet functions run during compilation on the master and not on the agent.
No, really. Not on the agent.
And that’s still true.
Because running functions on the master means that the catalog is a complete representation of the state we want on the node.
But… sometimes there are things that we just can’t put in the catalog, or have to be computed on the agent.
Puppet 6 introduces the concept of Deferred functions, to be run during the catalog enforcement.
In this talk I’ll show how that can be used to manage secrets on the node, without the master ever knowing those secrets.
I’ll also walk through the process of updating my popular node_encrypt module, which encrypts secrets as they pass through the catalog, to use Deferred functions to decrypt those secrets agent side, vastly broadening its capabilities."><meta name=twitter:image content=https://cfp.cfgmgmtcamp.be/uploads/d85d0957b76092b43455bd159836db4c3a1c32ea5c75fc2bb2.jpeg><meta name=twitter:image:alt content="Ben Ford"><link href="https://fonts.googleapis.com/css?family=Chivo:900" rel=stylesheet type=text/css><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel=stylesheet><link href=/css/leaflet.min.css rel=stylesheet type=text/css><link href=/css/reset.min.css rel=stylesheet type=text/css><link href=/css/stylesheet.min.css rel=stylesheet type=text/css media=screen><link href=/css/pygment_trac.min.css rel=stylesheet type=text/css media=screen><link href=/css/print.min.css rel=stylesheet type=text/css media=print><link href=/css/schedule.min.css rel=stylesheet type=text/css><link href=/css/schedule-single.min.css rel=stylesheet type=text/css><link href=https://use.fontawesome.com/releases/v5.6.3/css/all.css rel=stylesheet><link rel="shortcut icon" href=favicon.ico><script src=/js/leaflet.min.js></script><title>Agent-side functions in Puppet 6. Wait, that&#39;s a thing?</title></head><body><nav><a href=# id=menu-icon>&#x2261;</a><ul><li><a href=/><img src=/images/logo_top.png alt=CfgMgmtCamp></a></li><li><a href=/about/>About</a> |</li><li><a href=https://registration.cfgmgmtcamp.be/ghent/2019/>Registration</a> |</li><li><a href=/sponsors/>Sponsors</a> |</li><li><a href=/location/>Location</a> |</li><li><a href=/schedule/>Schedule</a> |</li><li><a href=/fringes/>Fringe</a> |</li><li><a href=/speaker/>Speakers</a> |</li><li><a href=/codeofconduct/>Conduct</a> |</li><li><a href=https://archive.cfgmgmtcamp.eu/>Archive</a> |</li></ul></nav><section id=talk><div id=talk><h1>Agent-side functions in Puppet 6. Wait, that&#39;s a thing?</h1><h2><a href=/speaker/benford>Ben Ford</a> <span style=font-size:1em><a href=https://twitter.com/binford2k><i class="fab fa-twitter"></i>@binford2k</a></span> <a href=https://github.com/binford2k><i class="fab fa-github"></i>binford2k</a></h2><h3><a href=https://cfgmgmtcamp.eu/room/3.puppet/>B.1.015</a>
-
Tuesday 5th February 2019
-
15:00 &rarr; 15:25</h3><div class=event-info><p>For a long time now, a common refrain in the #puppet IRC and now Slack channels has been explaining
how Puppet functions run during compilation on the master and not on the agent.<br>No, really. Not on the agent.</p><p>And that&rsquo;s still true.<br>Because running functions on the master means that the catalog is a complete representation of the state we want on the node.<br>But&hellip; sometimes there are things that we just can&rsquo;t put in the catalog, or have to be computed on the agent.<br>Puppet 6 introduces the concept of Deferred functions, to be run during the catalog enforcement.</p><p>In this talk I&rsquo;ll show how that can be used to manage secrets on the node, without the master ever knowing those secrets.<br>I&rsquo;ll also walk through the process of updating my popular node_encrypt module, which encrypts secrets as they pass through the catalog,
to use Deferred functions to decrypt those secrets agent side, vastly broadening its capabilities.</p></div><div class=event-speaker><h2>Speaker Info</h2><img src=https://cfp.cfgmgmtcamp.be/uploads/d85d0957b76092b43455bd159836db4c3a1c32ea5c75fc2bb2.jpeg alt="Ben Ford"><p>Developer Advocate on the Puppet Community Team.</p></div></div></section><footer><div>CfgMgmtCamp is a free open source event. CfgMgmtCamp logo is property of the CfgMgmtCamp group.<br>Copyleft 2014 - 2019, CfgMgmtCamp.<br>Git 4a8e854<br></div></footer><script type=text/javascript>var _paq=_paq||[];_paq.push(['setDoNotTrack',false]);_paq.push(["setDocumentTitle",document.domain+"/"+document.title]);_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);_paq.push(['enableHeartBeatTimer',5]);_paq.push(['setLinkTrackingTimer',25]);(function(){var u="https:\/\/stats.vantosh.com/";_paq.push(['setTrackerUrl',u+'piwik.php']);_paq.push(['setSiteId',"45"]);var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.type='text/javascript';g.async=true;g.defer=true;g.src=u+'piwik.js';s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="https://stats.vantosh.com/piwik.php?idsite=45" style=border:0 alt></p></noscript></body></html>